<!DOCTYPE html>
<html>
  <head>
    <title>WebAR with Firebase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; gpsMinAccuracy: 100; gpsTimeInterval: 1000;">

      <a-camera gps-camera rotation-reader></a-camera>

    </a-scene>

    <script>
      // TODO: Replace with your Firebase project config
      const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
        projectId: "YOUR_PROJECT_ID",
        storageBucket: "YOUR_PROJECT_ID.appspot.com",
        messagingSenderId: "YOUR_SENDER_ID",
        appId: "YOUR_APP_ID"
      };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      db.collection("ar_objects").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();

          const entity = document.createElement('a-entity');
          entity.setAttribute('gltf-model', data.file_url);
          entity.setAttribute('gps-entity-place', `latitude: ${data.latitude}; longitude: ${data.longitude}`);
          entity.setAttribute('scale', '2 2 2');
          entity.setAttribute('animation-mixer', '');

          document.querySelector('a-scene').appendChild(entity);
        });
      }).catch(error => {
        console.error("Error loading AR objects:", error);
      });
    </script>
  </body>
</html>
