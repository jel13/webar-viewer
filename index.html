<!DOCTYPE html>
<html>
  <head>
    <title>WebAR with Firebase</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; gpsMinAccuracy: 100; gpsTimeInterval: 1000;">

      <a-camera gps-camera rotation-reader></a-camera>

    </a-scene>

    <script>
      // TODO: Replace with your Firebase project config
      const firebaseConfig = {
          apiKey: "AIzaSyB8sohC94FQQWAHLl1MFB5d9ZJ5UXiz2wc",
          authDomain: "bacootrip.firebaseapp.com",
          projectId: "bacootrip",
          storageBucket: "bacootrip.firebasestorage.app",
          messagingSenderId: "750857744363",
          appId: "1:750857744363:web:76f5c5d79d00dc318bf3ae"
        };

      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      db.collection("ar_objects").get().then(snapshot => {
        snapshot.forEach(doc => {
          const data = doc.data();

          const entity = document.createElement('a-entity');
          entity.setAttribute('gltf-model', data.file_url);
          entity.setAttribute('gps-entity-place', `latitude: ${data.latitude}; longitude: ${data.longitude}`);
          entity.setAttribute('scale', '2 2 2');
          entity.setAttribute('animation-mixer', '');

          document.querySelector('a-scene').appendChild(entity);
        });
      }).catch(error => {
        console.error("Error loading AR objects:", error);
      });
    </script>
  </body>
</html>
